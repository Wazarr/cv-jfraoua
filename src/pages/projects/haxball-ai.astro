---
import ProjectLayout from "../../layouts/ProjectLayout.astro";
---

<ProjectLayout title="HaxballGym - AI Training Framework">
  <h1 class="text-gray-900 dark:text-gray-100">HaxballGym AI Training Framework</h1>
  
  <div class="mb-4">
    <a
      href="https://github.com/HaxballGym"
      target="_blank"
      rel="noopener noreferrer"
      class="inline-flex items-center space-x-2 text-primary-400 hover:text-primary-300 font-mono font-semibold"
    >
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        class="w-5 h-5"
      >
        <path
          d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"
        ></path>
      </svg>
      <span>â†’ github.com/HaxballGym</span>
    </a>
  </div>

  <h2 class="text-gray-900 dark:text-gray-100 mt-2">Overview</h2>

  <p class="text-gray-800 dark:text-gray-200">A comprehensive reinforcement learning framework for training AI agents to play <a href="https://www.haxball.com" class="text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300">Haxball</a>, a popular online 2D soccer game. This project demonstrates advanced RL techniques applied to a real-time competitive environment.</p>

  <p class="text-gray-800 dark:text-gray-200">The framework provides a complete ecosystem for developing and training AI agents, including a Python recreation of the game engine, OpenAI Gym environment with custom reward functions, and integration with state-of-the-art reinforcement learning algorithms.</p>

  <h2 class="text-gray-900 dark:text-gray-100">AI Performance Demo</h2>

  <video controls width="600" class="w-full mb-4 rounded-lg shadow-lg">
    <source src="/ai_vs_chaser.mov" type="video/mp4" />
    Your browser does not support the video tag.
  </video>

  <p class="text-gray-700 dark:text-gray-300"><em>AI agent (red) defeating a simple chase bot 6-1, demonstrating game understanding and strategic play</em></p>

  <h2 class="text-gray-900 dark:text-gray-100">Architecture Components</h2>

  <h3 class="text-gray-900 dark:text-gray-100">Ursinaxball</h3>
  <p class="text-gray-800 dark:text-gray-200">Python recreation of Haxball using the Ursina game engine, reverse-engineered from deobfuscated JavaScript code of the original browser game.</p>

  <h3 class="text-gray-900 dark:text-gray-100">HaxballGym Environment</h3>
  <p class="text-gray-800 dark:text-gray-200">Custom OpenAI Gym environment implementing:</p>
  <ul class="text-gray-800 dark:text-gray-200">
    <li><strong class="text-gray-900 dark:text-gray-100">State space</strong>: Player positions, velocities, ball state</li>
    <li><strong class="text-gray-900 dark:text-gray-100">Action space</strong>: Discrete movement and kick actions</li>
    <li><strong class="text-gray-900 dark:text-gray-100">Reward functions</strong>: Goal scoring, ball possession, positioning</li>
    <li><strong class="text-gray-900 dark:text-gray-100">Terminal conditions</strong>: Game completion, time limits</li>
  </ul>

  <h3 class="text-gray-900 dark:text-gray-100">Training Pipeline</h3>
  <p class="text-gray-800 dark:text-gray-200">Integration with Stable-Baselines3 implementing PPO (Proximal Policy Optimization) for agent training with custom reward shaping.</p>

  <h3 class="text-gray-900 dark:text-gray-100">WazBot Starter Kit</h3>
  <p class="text-gray-800 dark:text-gray-200">Quick-start repository with documentation and examples for training custom Haxball AI agents.</p>

  <h2 class="text-gray-900 dark:text-gray-100">Technical Stack</h2>

  <ul class="text-gray-800 dark:text-gray-200">
    <li><strong class="text-gray-900 dark:text-gray-100">Python</strong> - Core implementation language</li>
    <li><strong class="text-gray-900 dark:text-gray-100">Ursina Engine</strong> - 3D game engine for physics simulation</li>
    <li><strong class="text-gray-900 dark:text-gray-100">OpenAI Gym</strong> - RL environment framework</li>
    <li><strong class="text-gray-900 dark:text-gray-100">Stable-Baselines3</strong> - RL algorithm implementation</li>
    <li><strong class="text-gray-900 dark:text-gray-100">PyTorch</strong> - Neural network backend</li>
  </ul>

  <h2 class="text-gray-900 dark:text-gray-100">Key Challenges</h2>

  <h3 class="text-gray-900 dark:text-gray-100">Game Engine Recreation</h3>
  <p class="text-gray-800 dark:text-gray-200">Deobfuscating and understanding the original JavaScript physics engine required extensive reverse engineering. Converting to Python while maintaining gameplay fidelity posed significant architectural challenges.</p>

  <h3 class="text-gray-900 dark:text-gray-100">Reward Engineering</h3>
  <p class="text-gray-800 dark:text-gray-200">Designing reward functions that encourage realistic soccer behavior without reward hacking. Balancing exploration vs exploitation in the competitive game environment.</p>

  <h3 class="text-gray-900 dark:text-gray-100">Training Stability</h3>
  <p class="text-gray-800 dark:text-gray-200">Achieving consistent training performance across different opponents and scenarios while preventing overfitting to specific game situations.</p>

  <h2 class="text-gray-900 dark:text-gray-100">Performance Results</h2>

  <p class="text-gray-800 dark:text-gray-200">The best-performing model (trained for 1 week) achieves:</p>
  <ul class="text-gray-800 dark:text-gray-200">
    <li><strong class="text-gray-900 dark:text-gray-100">Consistent wins</strong> against beginner-level players</li>
    <li><strong class="text-gray-900 dark:text-gray-100">Strong defensive positioning</strong> and ball interception</li>
    <li><strong class="text-gray-900 dark:text-gray-100">Basic tactical understanding</strong> of game flow</li>
    <li><strong class="text-gray-900 dark:text-gray-100">Limitations</strong>: Struggles with precision shots and advanced techniques</li>
  </ul>

  <p class="text-gray-800 dark:text-gray-200">Current performance suggests potential to challenge intermediate players with more diverse training scenarios.</p>

  <h2 class="text-gray-900 dark:text-gray-100">Community Impact</h2>

  <p class="text-gray-800 dark:text-gray-200">The framework has attracted interest from master students. The open-source nature has enabled collaborative improvements and extensions.</p>
</ProjectLayout>
